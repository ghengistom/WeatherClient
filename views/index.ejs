<!DOCTYPE html>
<html>
  <head>
    <title>The Weather Station</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel='stylesheet' href='/stylesheets/style.css' />
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="/javascripts/knockoutmin.js"></script>
  
    
  </head>
  <body>
  <!--  <script src="javascripts/graphLogic.js" type="text/javascript"></script>   -->
  <div class="jumbotron text-center">
    <h1>Webserver Temperature</h1>
    <p>Temperature versus Time</p> 
  </div>

    <div class="container-fluid">
      <div id="tester" style="width:800px;height:400px;">

    </div>
 
      
     
    </div>
     <script>
      //make server get request to pi
      $.get( "http://47.153.171.2:9000/gethistory", function(data) {

            results = data;

            var dates = [];
            var temps = [];
            for(var i=0; i < results.length; ++i) {
            
            dates.push(results[i][0]);
            temps.push(results[i][1]);
      }
        TESTER = document.getElementById('tester');
        Plotly.plot( TESTER, [{
        x: dates,
        y: temps }], {
        margin: { t: 0 } } );
      })     
       </script>



<input id="testbutton" type="button" value="Test" />
<p id="results">results appended here: </p>


<span id="displayTemp">Current Temperature and Time  </span>

<!--<p>Current Temperature: <strong data-bind="text: temp">todo</strong></p>-->







<script
src="https://code.jquery.com/jquery-3.3.1.min.js"
integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
crossorigin="anonymous"></script>
<script type="text/javascript">
$(document).ready(function() {
  $("#testbutton").click(function() {
      $.ajax({
          url: 'http://47.153.171.2:9000/gettemp',
          dataType: 'json',
          success: function(data) {
              //$("#results").append('all good');
              //alert(data);
              $("span").appendTo(displayTemp).append("<br>" + data + "<br>");
              

  // This is a simple *viewmodel* - JavaScript that defines the data and behavior of your UI
              
              // function AppViewModel() {

              //   $("#main").append("<div id='dynamic' data-bind='text: fullName'></div>");


              //  // ko.cleanNode(data[0]);
              //   //ko.cleanNode($this.temp);
              //   this.temp = data;
              //  // ko.cleanNode(data[0]);
                
              // }

  // Activates knockout.js

  // ko.applyBindings(new AppViewModel());
  
  

              
          },
           error: function() {
              $("#results").append("error");
              alert('error');
          }
      });
  });
});


</script>

<script>
  // This is a simple *viewmodel* - JavaScript that defines the data and behavior of your UI
  // function AppViewModel() {
  //   this.firstName = "Bert";
  //   this.lastName = "Bertington";
  // }

  // // Activates knockout.js
  // ko.applyBindings(new AppViewModel());
</script>



  </body>
</html>
